(window.LearnosityAmd=window.LearnosityAmd||[]).push([[70],{134:function(e,t,n){"use strict";n.d(t,"b",(function(){return isArrowKey})),n.d(t,"c",(function(){return isEnterOrSpace}));var r=n(0),o=n.n(r);function isArrowKey(e){return o.a.contains([37,38,39,40],e)}function isEnterOrSpace(e){return 32===e||13===e}t.a={PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,ESCAPE:27,ENTER:13,TAB:9,SHIFT:16,SPACE:32,DELETE:46,ADD_EQUAL:187,FF_ADD_EQUAL:61,NUM_PAD_ADD:107,MINUS:189,FF_MINUS:173,NUM_PAD_MINUS:109,NUM_PAD_MULTIPLY:106,DIVIDE:191,NUM_PAD_DIVIDE:111,DECIMAL:190,NUM_PAD_DECIMAL:110,NUMBER_0:48,NUMBER_1:49,NUMBER_2:50,NUMBER_3:51,NUMBER_4:52,NUMBER_5:53,NUMBER_6:54,NUMBER_7:55,NUMBER_8:56,NUMBER_9:57,NUM_PAD_0:96,NUM_PAD_1:97,NUM_PAD_2:98,NUM_PAD_3:99,NUM_PAD_4:100,NUM_PAD_5:101,NUM_PAD_6:102,NUM_PAD_7:103,NUM_PAD_8:104,NUM_PAD_9:105}},135:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(17),a=n.n(i),s=n(36),l=n(133),c={CORRECT:"correct",INCORRECT:"incorrect",VALID:"valid"},u={globalText:function globalText(e,t){return e===c.CORRECT?t.correctResponse:e===c.INCORRECT?t.incorrectResponse:""},correctText:function correctText(e,t){var n="";if(!o.a.isEmpty(e)){var r=e.length;n+=r>1?Object(l.a)(t.numberOfCorrectAnswers,{number:r}):t.oneCorrectAnswer}return n+=o.a.pluck(e,"text").join(", ")},incorrectText:function incorrectText(e,t){var n="";if(!o.a.isEmpty(e)){var r=e.length;n+=r>1?Object(l.a)(t.numberOfIncorrectAnswers,{number:r}):t.oneIncorrectAnswer}return n+=o.a.pluck(e,"text").join(", ")},suggestedResponsesText:function suggestedResponsesText(e,t,n){var r="";if(e=o.a.filter(e,(function(e){return!o.a.findWhere(t,{text:e.text})})),!o.a.isEmpty(e)){var i=e.length;r+=i>1?Object(l.a)(n.numberOfExpectedAnswers,{number:i}):n.oneExpectedAnswer}return r+=o.a.pluck(e,"text").join(", ")}};function getGlobalAccessibility(e,t){var n=e===c.CORRECT?t?Object(l.a)(t.correctResponse):"response - correct":e===c.INCORRECT?t?Object(l.a)(t.incorrectResponse):"response - incorrect":void 0;return{label:n,visible:o.a.isString(n)}}function getText(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=a.a.stripHTML(a.a.createImageDescriptions(e),!1);if(t&&!n){var i=r.match(/\\\(\S*?\\\)/g)||[];i=i.concat(r.match(/\\\[\S*?\\]/g)||[]),o.a.each(i,(function(e){var t=e.replace("\\(","").replace("\\)","").replace("\\[","").replace("\\]",""),n="";s.a.translateOrEmptyString(t,(function(e){return n=e})),r=r.replace(e,n)}))}return r}t.a={STATES:c,ariaContentFunctions:u,getGlobalAccessibility:getGlobalAccessibility,getResponseAccessibility:function getResponseAccessibility(e){var t=e.value,n=e.state,r=e.isMath,i=e.validationState,a=e.ariaLiveLabels,s=e.minSelection,u=e.maxSelection,f=e.isMinSelectionWarningVisible,p=void 0!==f&&f,d=e.isMaxSelectionWarningVisible,h=void 0!==d&&d,y=e.disableSpokenmathDistractors,v=void 0!==y&&y,b=p||h,_=getGlobalAccessibility(i,a).visible||b,g=o.a.isFunction(n)?n():n,m=_&&t?getText(t,r,v):null;return{label:function(){if(_){var e=c.CORRECT,t=c.INCORRECT,n=c.VALID,r=m?"".concat(m," - "):"",o=s>1?a.minResponsesMessage:a.minResponseMessage,i=u>1?a.maxResponsesMessage:a.maxResponseMessage;return g===e?Object(l.a)(a.correct,{prefix:r}):g===t?Object(l.a)(a.incorrect,{prefix:r}):g===n?Object(l.a)(a.missed,{prefix:r}):h?Object(l.a)(i,{prefix:r,maxSelection:u}):p?Object(l.a)(o,{prefix:r,minSelection:s}):Object(l.a)(a.noResponseGiven,{prefix:r})}}(),visible:_}},getResponseState:function getResponseState(e,t){return o.a.isNull(e)&&o.a.isNull(t)?null:o.a.isString(e)&&t?c.CORRECT:o.a.isString(e)&&!t?c.INCORRECT:o.a.isNull(e)&&!t?c.VALID:void 0},getText:getText,getAriaLabelFromAllElements:function getAriaLabelFromAllElements(e){var t=document.createElement("div");return t.innerHTML=e,function stripElementContent(e){return e.map((function(e){if(e.attributes&&e.attributes.alt)return"Image with alt text: ".concat(e.attributes.alt.value);if(e.attributes&&e.attributes["aria-label"])return e.attributes["aria-label"].value;if(e.children){var t=[].slice.call(e.childNodes);return stripElementContent(t).join(" ")}return e.textContent}))}([].slice.call(t.childNodes)).join(", ")}}},138:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i={"lower-alpha":"a","upper-alpha":"A",number:1};t.a=function stemNumerationHelper(e,t){if(!e)return"";var n=i[e];return t=o.a.isNumber(t)?t:parseInt(t,10),"string"==typeof n?String.fromCharCode(n.charCodeAt(0)+t):"number"==typeof n?(n+t).toString():void 0}},140:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(127),a=n.n(i),s=n(131),l=n(129),c=n(21);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function renderFeatures(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.features,i=n.removeOnComplete;return o.a.isEmpty(r)?null:a.a.createElement("div",{className:t},o.a.map(r,(function(e,t){var n=!!e._last;return(a.a.createElement(u,{key:t,feature:e,isLastFeature:n,removeOnComplete:i}))})))}var u=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(EmbeddedFeature,e);var t=_createSuper(EmbeddedFeature);function EmbeddedFeature(){return _classCallCheck(this,EmbeddedFeature),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(EmbeddedFeature,[{key:"render",value:function render(){var e=this;return(a.a.createElement("div",{ref:function ref(t){return e.el=t}}))}},{key:"componentDidMount",value:function componentDidMount(){var e=this.props,t=e.feature,n=e.baseActions,r=e.isLastFeature,o=e.removeOnComplete;n.legacyRenderEmbeddedFeature({feature:t,isLastFeature:r,removeOnComplete:o,el:this.el})}}]),EmbeddedFeature}(a.a.Component);u=l.b(null,(function(e){return{baseActions:s.b(c.a,e)}}))(u),t.a={VerticalFeatures:function VerticalFeatures(e){return renderFeatures(e,"lrn_stimulus_features_vertical")},OverlayFeatures:function OverlayFeatures(e){return renderFeatures(e,"lrn_stimulus_features_overlay",{removeOnComplete:!0})}}},145:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(128),a=n.n(i),s=n(127),l=n.n(s),c=n(129),u=n(140),f=n(154),p=n(7),d=n(155);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h={XSMALL:{className:"lrn-xs",minWidth:0},SMALL:{className:"lrn-sm",minWidth:481},MEDIUM:{className:"lrn-md",minWidth:801},LARGE:{className:"lrn-lg",minWidth:1200}};function ResponsiveWidget(e){if(!e.responsive)return e.children;return l.a.createElement(d.a.Detector,{onChange:function onSizeChange(t){var n=o.a.chain(h).filter((function(e){return e.minWidth<=t.width})).pluck("className").value().join(" ");e.onChange&&e.onChange(_objectSpread(_objectSpread({},t),{},{responsiveClassName:n}))}},e.children)}var y=function applyResponsiveWidgetLayout(e){var t;e.state=o.a.extend({},e.state,{dimensions:{width:0,height:0},layoutMode:"split"}),e.render=function(){var n=e.baseClassName,r=e.state,i=e.props.base,a=i.responseId,s=i.widgetLayout,c=function getLayoutData(e,t){if("stack"===e){return{layoutClassName:"",elements:o.a.map(t,(function(e){return{type:e.type,width:"",paddingLeft:"",paddingRight:""}}))}}return{layoutClassName:"clearfix",elements:t}}(r.layoutMode,s.elements),u=c.elements,f=c.layoutClassName;return t||(t=o.a.findWhere(s.elements,{type:"interaction"})),l.a.createElement(d.a.Detector,{onChange:function onChange(n){return function onComponentResize(e,t,n){var r,o=t.width,i=e.state.layoutMode,a=(r=n.width||50,o*r/100<400?"stack":"split");a!==i&&e.setState({layoutMode:a})}(e,n,t)}},l.a.createElement("div",{id:a,className:"".concat(n," ").concat(f)},e.getInstructorStimulus(),o.a.map(u,(function(t,n){return l.a.createElement(d.a.Column,_extends({key:n},t),function getChildComponent(t){return"stimulus"===t?e.getStimulus():e.getQuestionContent()}(t.type))}))))}};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function baseQuestion_extends(){return(baseQuestion_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function baseQuestion_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(BaseQuestion,e);var t=_createSuper(BaseQuestion);function BaseQuestion(e){var n;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BaseQuestion),baseQuestion_defineProperty(_assertThisInitialized(n=t.call(this,e)),"state",{}),baseQuestion_defineProperty(_assertThisInitialized(n),"onSizeChange",(function(e){var t=e.responsiveClassName;n.setState({responsiveClassName:t})})),o.a.getNested(e,"base.widgetLayout.enabled")&&y(_assertThisInitialized(n)),n}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(BaseQuestion,[{key:"render",value:function render(){var e=this.baseClassName,t=this.props.base.responseId;return l.a.createElement(ResponsiveWidget,{responsive:this.props.responsive,onChange:this.onSizeChange},l.a.createElement("div",{id:t,className:e},this.getInstructorStimulus(),this.getStimulus(),this.getQuestionContent()))}},{key:"baseClassName",get:function get(){var e=this.props.base,t=e.questionType,n=e.fontSizeClass,r=e.inMaskingState;return a()({"lrn-masking":r,"lrn-ie":"ie"===p.a.browser,"lrn-ios":p.a.isIOS},n,this.state.responsiveClassName,"lrn lrn_widget lrn_qr lrn_clearfix lrn_".concat(t," ").concat(n))}},{key:"getQuestionContent",value:function getQuestionContent(){var e=this.props,t=e.base,n=e.children,r=t.stimulus,i=t.extraClassNames||{},a={responseWrapper:"lrn_response_wrapper ",response:"lrn_response lrn_clearfix "},s=o.a.getNested(t,"__legacyAttributes.extraClassNames")||{};return s.lrn_response_wrapper&&(a.responseWrapper+=s.lrn_response_wrapper),s.lrn_response&&(a.response+=s.lrn_response),a.responseWrapper+=i.responseWrapper||"",a.response+=i.response||"",l.a.createElement("div",{className:a.responseWrapper},l.a.createElement(u.a.OverlayFeatures,{features:r.legacyOverlayFeatures}),l.a.createElement("div",{className:a.response},n))}},{key:"getStimulus",value:function getStimulus(){var e=this.props.base,t=e.stimulus,n=e.stimulusReview,r=e.isReviewState,o=e.responseId,i=r&&n.visible?n:t;return l.a.createElement(f.a.Stimulus,baseQuestion_extends({},i,{responseId:o}))}},{key:"getInstructorStimulus",value:function getInstructorStimulus(){var e=this.props.base.stimulusInstructor;return(l.a.createElement(f.a.InstructorStimulus,e))}}]),BaseQuestion}(l.a.Component);v=c.b((function(e){return{base:e.base}}),null)(v);t.a=v},146:function(e,t,n){"use strict";var r=n(1),o=n.n(r),i=n(0),a=n.n(i),s=(n(54),document),l=o()("body");function unwatch(e){s.unbindLeave&&s.unbindLeave(e)}t.a={watch:function watch(e,t){l.find(e).length&&s.leave&&s.leave(e,a.a.debounce((function(){l.find(e).length||(t(),unwatch(e))}),10))},unwatch:unwatch}},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(127);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(Wrapper,e);var t=_createSuper(Wrapper);function Wrapper(){return _classCallCheck(this,Wrapper),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(Wrapper,[{key:"render",value:function render(){return this.props.children}}]),Wrapper}(n.n(r).a.PureComponent)},148:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(5),a=n.n(i),s=n(127),l=n.n(s),c=n(130),u=n.n(c),f=n(131),p=n(129),d=n(192),h=n(55),y=n(21),v=n(57),b=n(31),_=n(37),g=n(38),m=n(146),S=n(150),O=n(147);function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=a.a.View.extend({initialize:function initialize(){var e=this;this._responseId=this.model.get("response_id"),this.activity=this.options.activity,this.remove=this.remove.bind(this),this.initialisationCompleted=this.initialisationCompleted.bind(this);var t=this.getDataService();this.addFacadeMethods(this.getFacade()),t.prepare((function(){e.setLegacyAttributes(),e.render(),e.initialisationCompleted(),m.a.watch('[id="'.concat(e._responseId,'"]'),e.remove)}))},update:function update(){var e=this,t=this.getDataService(),n=this.getStore(),r=o.a.extend({},t.getInitialState()),i=this.widgetInstance;i&&o.a.isFunction(i.reset)&&i.reset(),n.dispatch({type:"UPDATE_ALL",payload:{data:r}}),this.prepareStoreState(),this.setLegacyAttributes();var a=y.a.renderMathIfRequired({success:function success(){e.onMathRendered()}});n.dispatch(a)},getDataService:function getDataService(){if(!this._dataService){var e=this.DataService;this._dataService=new e(this.model,this.getFacade())}return this._dataService},getStore:function getStore(){if(!this._store){var e=this.getDataService(),t=this.getReducers(),n=this.getMiddleware();o.a.each(t,(function(e,t){var n=e.setName;n&&n(t)})),this._store=Object(f.d)(Object(f.c)(t),e.getInitialState(),Object(S.a)(f.a.apply(void 0,_toConsumableArray(n)))),this.prepareStoreState()}return this._store},getMiddleware:function getMiddleware(){var e=this;return[d.a.withExtraArgument(this.getThunkServices()),function legacyMiddleWare(t){return function(t){return function(n){return n.type===y.a.actionTypes.QUESTION_LEGACY_BEGIN_RESPONSE&&e.beginResponse(),t(n)}}}]},getThunkServices:function getThunkServices(){var e=this;return{dataService:this.getDataService().getFacade(),mathService:this.getMathService(),simplefeatureService:{render:function renderViewSimpleFeatures(){return e.options.services.renderViewSimpleFeatures(e)}}}},getReducers:function getReducers(){return{base:h.a}},render:function render(){if(this.component)try{this.el&&u.a.unmountComponentAtNode(this.el)}catch(e){}else{var e=document.createElement("div");this.$el.replaceWith(e),this.setElement(e),this.$el.attr("data-lrn-widget-container",this._responseId).attr("data-lrn-widget-type","question")}return this.renderComponent()},renderComponent:function renderComponent(){var e=this,t=this.getStore(),n=this.ViewComponent,r=!0===this.forwardRef?l.a.createElement(n,{ref:function ref(t){return e.widgetInstance=t}}):l.a.createElement(n,null);return new Promise((function(n){u.a.render(l.a.createElement(O.a,{ref:function ref(t){return e.component=t}},l.a.createElement(p.a,{store:t},r)),e.el,n)}))},remove:function remove(){if(!this._removed){try{var e=u.a.findDOMNode(this.component);e&&!this.$el.find(e).length&&this.$el.append(e),this.el&&(this._unmounted=u.a.unmountComponentAtNode(this.el))}catch(e){}a.a.View.prototype.remove.call(this),m.a.unwatch('[id="'.concat(this._responseId,'"]')),this._removed=!0}},renderSimpleFeatures:function renderSimpleFeatures(e){return _.a.renderSimpleFeatures.call(this,this.$el,this.activity,e)},initialisationCompleted:function initialisationCompleted(){var e=this.getMathService(),t=this.options.mathRenderPromise;e.mathquillRendering()&&(t=e.renderMathquill()),t&&t.then(this.onMathRendered.bind(this)),this.imageLoader=new g.a({element:this.el}),this.imageLoader.loadImages(),this.options.initialisationCallback&&o.a.defer(this.options.initialisationCallback)},prepareStoreState:function prepareStoreState(){},getFacade:function getFacade(){if(o.a.isUndefined(this.questionFacade)){var e=new v.a(this).facade;this.questionFacade=e}return this.questionFacade},addFacadeMethods:function addFacadeMethods(e){},getMathService:function getMathService(){return o.a.isUndefined(this._mathService)&&(this._mathService=new b.a(this,"question")),this._mathService},setLegacyAttributes:function setLegacyAttributes(){var e=this.__legacyAttributes,t=y.a.setLegacyAttributes(e);this.getStore().dispatch(t)},onMathRendered:function onMathRendered(){var e=this.cacheRenderedMath.bind(this);this.getStore().dispatch(y.a.notifyMathRendered({cacheRenderedMath:e}))},cacheRenderedMath:function cacheRenderedMath(e){e&&this.getStore().dispatch(y.a.cacheRenderedMath({mathInResponse:e}))},setDisabled:function setDisabled(e){var t=this.activity.get("state"),n=this.activity.STATE,r=[n.INITIAL,n.RESUME],i=this.getStore().getState().base.disabled;return!(!o.a.contains(r,t)||i===e)&&(e?this.undelegateEvents():this.delegateEvents(),this.getStore().dispatch(y.a.setDisabled(e)),!0)},beginResponse:function beginResponse(){},pauseResponse:function pauseResponse(){},stopResponse:function stopResponse(){},masking:function masking(e,t){this.getStore().dispatch(y.a.setMaskingState(e,t))},reset:function reset(){this.getFacade().trigger("reset")}});t.a=R},150:function(e,t,n){"use strict";var r;r=function composeWithDevTools(e){return e},t.a=r},154:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(140),a=n(127),s=n.n(a);t.a={Stimulus:function Stimulus(e){if(!e.visible)return null;var t=e.responseId;return s.a.createElement("div",{className:"lrn_question"},s.a.createElement("div",{className:"lrn_stimulus lrn_clearfix"},s.a.createElement("div",{className:"lrn_stimulus_content lrn_clearfix",dangerouslySetInnerHTML:{__html:e.content},id:"stimulus-".concat(t)}),function renderLegacyVerticalFeatures(){var t=e.legacyVerticalFeatures,n=e.legacyEvents,r=e.i18n;if(!o.a.isEmpty(t))return s.a.createElement(i.a.VerticalFeatures,{features:t,i18n:r,events:n})}()))},InstructorStimulus:function InstructorStimulus(e){return e.visible?s.a.createElement("div",{className:"lrn_question"},s.a.createElement("div",{className:"lrn-instructor-stimulus"},s.a.createElement("div",{className:"lrn_clearfix"},s.a.createElement("div",{className:"lrn-instructor-stimulus-content",dangerouslySetInnerHTML:{__html:e.content}})))):null}}},155:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(40),a=n.n(i),s=n(127),l=n.n(s),c=n(130),u=n.n(c),f=n(24);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(Detector,e);var t=_createSuper(Detector);function Detector(e){var n;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Detector),function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(_assertThisInitialized(n=t.call(this,e)),"onWrapperSizeChange",o.a.debounce((function(){var e=_assertThisInitialized(n),t=e.onChange,r=e.el;t&&r&&!n._unmounted&&t({width:r.offsetWidth,height:r.offsetHeight})}),400)),o.a.isFunction(e.onChange)&&(n.onChange=e.onChange),n}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(Detector,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.el=u.a.findDOMNode(this),this.resizeSensor=Object(f.a)(this.el,(function(){return new a.a(e.el,e.onWrapperSizeChange)})),this.onWrapperSizeChange()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._unmounted=!0,this.resizeSensor.detach(this.onWrapperSizeChange),this.el=null}},{key:"render",value:function render(){var e=this.props.children;return l.a.Children.only(e)}}]),Detector}(l.a.PureComponent);t.a={Detector:p,Column:function Column(e){var t=function(e){var t=function formatValue(e){return e?"".concat(e,"%"):""},n=e.width,r=e.paddingLeft,o=e.paddingRight;return{width:t(n),paddingLeft:t(r),paddingRight:t(o),float:n?"left":""}}(e);return(l.a.createElement("div",{style:t},e.children))}}},172:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(127),a=n.n(i),s=n(131),l=n(129),c=n(135),u=n(23);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(AriaLiveRegion,e);var t=_createSuper(AriaLiveRegion);function AriaLiveRegion(e){var n;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AriaLiveRegion),function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(_assertThisInitialized(n=t.call(this,e)),"reset",(function(){n.props.validatableActions.clearValidationAriaLive(),document.removeEventListener("focusin",n.reset),n._focusEventAdded=!1}));var r=e.contentFunctions;return n.contentFunctions=o.a.extend({},c.a.ariaContentFunctions,r),n}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(AriaLiveRegion,[{key:"UNSAFE_componentWillReceiveProps",value:function UNSAFE_componentWillReceiveProps(e){this.shouldBeVisible(e)&&!this._focusEventAdded&&(document.addEventListener("focusin",this.reset),this._focusEventAdded=!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._focusEventAdded=!1,document.removeEventListener("focusin",this.reset)}},{key:"render",value:function render(){var e=this.shouldBeVisible(this.props);return(a.a.createElement("div",{className:"lrn-accessibility-arialive","aria-live":"assertive","aria-atomic":"true"},e&&this.buildContent()))}},{key:"shouldBeVisible",value:function shouldBeVisible(e){var t=e.base,n=e.validatable,r=t.isReviewState,o=n.ariaLive;return!r&&o.visible}},{key:"buildContent",value:function buildContent(){var e=this.props.validatable,t=this.props.base.i18n.labels.ariaLiveText,n=e.ariaLive,r=this.contentFunctions,o=r.globalText,i=r.correctText,a=r.incorrectText,s=r.suggestedResponsesText,l=[],c=function appendText(e){e&&l.push(e)};return c(o(e.validationState,t)),n.message?c(n.message):(c(i(n.correct,t)),c(a(n.incorrect,t)),c(t.selected),c(s(n.suggestedResponses,n.correct,t))),l.join(". ")}}]),AriaLiveRegion}(a.a.Component);f=l.b((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{validatableActions:{clearValidationAriaLive:s.b(u.a.clearValidationAriaLive,e)}}}))(f),t.a={AriaLiveRegion:f,ScreenReaderAriaText:function ScreenReaderAriaText(e){var t=e.data;return t.visible?a.a.createElement("span",{className:"lrn-accessibility-label"},t.label):null},GlobalValidationLabel:function GlobalValidationLabel(e){var t=e.label;return(a.a.createElement("div",{className:"sr-only"},t))}}},177:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(148),a=n(23),s=n(58),l=n(14);t.a=i.a.extend({initialize:function initialize(){var e=this,t=this.model;this.listenTo(t,t.EVENT.CALLVALIDATE,(function(t){e.callValidate(t)})),i.a.prototype.initialize.apply(this,arguments)},getReducers:function getReducers(){var e=i.a.prototype.getReducers.apply(this,arguments);return o.a.extend(e,{validatable:s.a})},callValidate:function callValidate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.model.canValidateResponse()){var t=this.getDataService(),n=!(!e.showCorrectAnswer&&!e.showCorrectAnswers),r=t.canShowGlobalValidationUI,i=o.a.isBoolean(e.feedbackAttempts)?e.feedbackAttempts:!!e.feedback_attempts,s=o.a.isUndefined(e.showDistractorRationale)?t.showDistractorRationale:Object(l.g)(e.showDistractorRationale);this.getStore().dispatch(a.a.checkAnswer({canShowCorrectAnswers:n,canShowGlobalValidationUI:r,showDistractorRationale:s,shouldValidateUnattempedResponse:n,skipAttemptCountLimit:!i}))}},setLegacyAttributes:function setLegacyAttributes(){var e=this.__legacyAttributes,t=a.a.setLegacyAttributes(e);i.a.prototype.setLegacyAttributes.call(this),this.getStore().dispatch(t)}})},179:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(127),a=n.n(i),s=n(131),l=n(129),c=n(21),u=n(23),f=n(145),p=n(172),d=n(188),h=n(128),y=n.n(h),v=n(17),b=n.n(v),_=n(138),g=n(14),m=n(3);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function shouldBeVisible(e,t,n,r){if(o.a.isNull(n)){if("review"===r&&e!==g.e&&e!==g.d&&o.a.isEmpty(t))return!0;if(!o.a.isNull(t)&&!o.a.isEmpty(t)){var i=o.a.filter(t,(function(e){return!1===e})).length;if(e===g.e)return 0===i;if(e===g.f)return i>0}}return e===g.c||e===n}var S=function(e){_inherits(DistractorRationalePerQuestion,e);var t=_createSuper(DistractorRationalePerQuestion);function DistractorRationalePerQuestion(){return _classCallCheck(this,DistractorRationalePerQuestion),t.apply(this,arguments)}return _createClass(DistractorRationalePerQuestion,[{key:"componentDidMount",value:function componentDidMount(){this.visible()&&this.props.onVisible()}},{key:"render",value:function render(){var e=this.props,t=e.html,n=e.perQuestionlabel;return this.visible()?a.a.createElement("div",{className:"lrn_distractor_rationale_per_question",dangerouslySetInnerHTML:{__html:b.a.sanitizeHTML(t)},"aria-label":n}):null}},{key:"visible",value:function visible(){var e=this.props,t=e.html,n=e.showDistractorRationalePerQuestion,r=e.validatedResponses,o=e.validationState,i=e.viewState;return t&&shouldBeVisible(n,r,o,i)}}]),DistractorRationalePerQuestion}(a.a.Component),O=function(e){_inherits(DistractorRationalePerResponseList,e);var t=_createSuper(DistractorRationalePerResponseList);function DistractorRationalePerResponseList(){return _classCallCheck(this,DistractorRationalePerResponseList),t.apply(this,arguments)}return _createClass(DistractorRationalePerResponseList,[{key:"componentDidMount",value:function componentDidMount(){this.visible()&&this.props.onVisible()}},{key:"render",value:function render(){var e=y()("lrn_distractor_rationale_list",this.props.className),t=this.props,n=t.items,r=t.title,o=t.ariaLabel,i=t.validationStemNumeration;return this.visible()?a.a.createElement("div",{className:e,"aria-label":o},a.a.createElement("div",{className:"lrn_distractor_rationale_list_title"},r),n.map((function(e){return a.a.createElement("div",{key:e.index,className:"lrn_distractor_rationale"},a.a.createElement("div",{className:"lrn_validation_stem_numeration"},Object(_.a)(i,e.index)),a.a.createElement("div",{className:"lrn_distractor_rationale_content",dangerouslySetInnerHTML:{__html:b.a.sanitizeHTML(e.metadata)}}))}))):null}},{key:"visible",value:function visible(){var e=this.props,t=e.items,n=e.showDistractorRationalePerResponse,r=e.validatedResponses,o=e.validationState;return t.length&&shouldBeVisible(n,r,o)}}]),DistractorRationalePerResponseList}(a.a.Component),R=function(e){_inherits(DistractorRationale,e);var t=_createSuper(DistractorRationale);function DistractorRationale(){var e;_classCallCheck(this,DistractorRationale);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _defineProperty(_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"onDistractorComponentsVisible",o.a.debounce((function(){e.props.baseActions.renderMathIfRequired()}),100)),e}return _createClass(DistractorRationale,[{key:"render",value:function render(){var e=this.props,t=e.validatable,n=e.base,r=t.questionLevelDistractorRationale,i=t.responseLevelDistractorRationale,s=t.showDistractorRationale,l=t.validationState,c=t.validatedResponses,u=t.validationStemNumeration,f=[m.QUESTION_TYPES.MCQ,m.QUESTION_TYPES.CLOZEASSOCIATION,m.QUESTION_TYPES.CLOZEDROPDOWN,m.QUESTION_TYPES.CLOZETEXT];if(!("review"===n.state||c&&o.a.contains(f,n.questionType)))return null;var p=Object(g.h)(i,g.f),d=Object(g.h)(i,g.e),h=n.i18n.labels,y=h.distractorRationale,v=h.ariaLabel;return a.a.createElement("div",{className:"lrn_distractor_rationale_wrapper",role:"region","aria-label":v.distractorRationale.distractorRationale},a.a.createElement(S,{html:r,showDistractorRationalePerQuestion:s.perQuestion,validatedResponses:c,validationState:l,viewState:n.state,perQuestionlabel:v.distractorRationale.perQuestion,onVisible:this.onDistractorComponentsVisible}),a.a.createElement(O,{className:"lrn_distractor_rationale_incorrect",items:p,showDistractorRationalePerResponse:s.perResponse,title:y.incorrectTitle,validatedResponses:c,validationState:"incorrect",validationStemNumeration:u,ariaLabel:v.distractorRationale.perResponseIncorrect,onVisible:this.onDistractorComponentsVisible}),a.a.createElement(O,{className:"lrn_distractor_rationale_correct",items:d,showDistractorRationalePerResponse:s.perResponse,title:y.correctTitle,validatedResponses:c,validationState:"correct",validationStemNumeration:u,ariaLabel:v.distractorRationale.perResponseCorrect,onVisible:this.onDistractorComponentsVisible}))}}]),DistractorRationale}(a.a.Component),k=n(181),P=n(135);var E={validation:function validation(e){return o.a.contains(["correct","incorrect"],e)?"lrn_".concat(e):""}};function validatable_typeof(e){return(validatable_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function validatable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function validatable_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function validatable_setPrototypeOf(e,t){return(validatable_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function validatable_createSuper(e){var t=function validatable_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=validatable_getPrototypeOf(e);if(t){var o=validatable_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return validatable_possibleConstructorReturn(this,n)}}function validatable_possibleConstructorReturn(e,t){if(t&&("object"===validatable_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return validatable_assertThisInitialized(e)}function validatable_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function validatable_getPrototypeOf(e){return(validatable_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function validatable_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=l.b((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{validatableActions:s.b({checkAnswer:u.a.checkAnswer},e)}}))(d.a),T=l.b((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{baseActions:s.b(c.a,e)}}))(R),C=l.b((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{baseActions:s.b(c.a,e)}}))(k.b),I={responseInput:{className:"lrn_response_input"},hasSuggestedAnswersList:!1},A=function(e){!function validatable_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&validatable_setPrototypeOf(e,t)}(ValidatableQuestion,e);var t=validatable_createSuper(ValidatableQuestion);function ValidatableQuestion(){var e;validatable_classCallCheck(this,ValidatableQuestion);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return validatable_defineProperty(validatable_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"validatedEventCount",0),e}return function validatable_createClass(e,t,n){return t&&validatable_defineProperties(e.prototype,t),n&&validatable_defineProperties(e,n),e}(ValidatableQuestion,[{key:"render",value:function render(){var e=this.props,t=e.children,n=e.validatable,r=e.base.i18n.labels.ariaLiveText,o=n.validationState,i=P.a.getGlobalAccessibility(o,r);return a.a.createElement(f.a,null,a.a.createElement(p.a.AriaLiveRegion,null),a.a.createElement(p.a.GlobalValidationLabel,{label:i.label}),t,a.a.createElement(w,null),a.a.createElement(T,null))}},{key:"componentDidUpdate",value:function componentDidUpdate(){var e=this.props,t=e.baseActions,n=e.validatable,r=n.validatedEventRequestCount,i=n.validatedResponses;o.a.isEmpty(i)||r===this.validatedEventCount||t.triggerEvent("validated"),this.validatedEventCount=r}}]),ValidatableQuestion}(a.a.Component);function ResponseInput(e){var t=e.validatable.validationState,n=o.a.extend({},I,e.options),r=n.className,i=n.style,s=E.validation(t);return a.a.createElement("div",{className:"".concat(r," ").concat(s),style:i},e.children)}A=l.b((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{baseActions:s.b(c.a,e)}}))(A);t.a={ResponseInput:ResponseInput,CheckAnswerButton:w,SuggestedAnswersList:C,DistractorRationale:T,ValidatableQuestion:A,ValidatableQuestionWithOptionalResponseInput:function ValidatableQuestionWithOptionalResponseInput(e){var t=o.a.extend({},I,e.options),n=o.a.getNested(e,"validatable.__legacyAttributes.willRenderOwnResponseInput");return a.a.createElement(A,e,a.a.createElement("div",{className:"lrn-response-validation-wrapper"},n&&e.children||a.a.createElement(ResponseInput,_extends({},e,{options:t.responseInput}),e.children)),t.hasSuggestedAnswersList&&a.a.createElement(C,null))}}},181:function(e,t,n){"use strict";n.d(t,"a",(function(){return ResponseIndex}));var r=n(0),o=n.n(r),i=n(127),a=n.n(i),s=n(138);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ResponseIndex(e){var t=e.index,n=e.validationStemNumeration,r=e.domProps,o=void 0===r?{}:r;return(a.a.createElement("span",_extends({className:"lrn_responseIndex"},o),Object(s.a)(n,t)))}var l=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(SuggestedAnswersList,e);var t=_createSuper(SuggestedAnswersList);function SuggestedAnswersList(){return _classCallCheck(this,SuggestedAnswersList),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(SuggestedAnswersList,[{key:"componentDidUpdate",value:function componentDidUpdate(){this.shouldBeVisible()&&this.props.baseActions.renderMathIfRequired()}},{key:"render",value:function render(){var e=this.props,t=e.base,n=e.customListItems,r=t.i18n.labels;if(this.shouldBeVisible()){var i=this.isSingleAnswer,s=this.buildListItems,l=i?r.correctAnswer:r.correctAnswers,c=i?"lrn_single_correct_answer":"",u=(n||s).call(this);return o.a.isEmpty(u)?null:a.a.createElement("div",{className:"lrn_correctAnswers"},a.a.createElement("span",null,l,":"),a.a.createElement("ul",{className:"lrn_correctAnswerList ".concat(c)},u))}return null}},{key:"isSingleAnswer",get:function get(){var e=this.props.validatable.suggestedResponses;return!o.a.isArray(e.value)}},{key:"buildNestedResponseItem",value:function buildNestedResponseItem(e){var t=this,n=e.value,r=e.index;return o.a.isEmpty(n)?null:a.a.createElement("li",{key:r},this.getResponseIndex(r),n.length>1&&a.a.createElement("ul",{className:"lrn_nestedCorrectAnswers"},o.a.map(n,(function(e,n){return a.a.createElement("li",{key:n},t.getResponseText(e,n))}))),1===n.length&&this.getResponseText(n[0]))}},{key:"buildListItems",value:function buildListItems(){var e=this,t=this.props.validatable.suggestedResponses;return this.isSingleAnswer?this.buildResponseItem({label:t.value},0):o.a.map(t.value,(function(t,n){if(o.a.isArray(t.value))return e.buildNestedResponseItem(t);var r=o.a.isNumber(t.index)?t.index:n;return e.buildResponseItem(t,r)}))}},{key:"buildResponseItem",value:function buildResponseItem(e,t){return a.a.createElement("li",{key:t},this.getResponseIndex(t),this.getResponseText(e))}},{key:"getResponseIndex",value:function getResponseIndex(e){var t=this.props.validatable.validationStemNumeration;return(a.a.createElement(ResponseIndex,{index:e,validationStemNumeration:t}))}},{key:"getResponseText",value:function getResponseText(e,t){return a.a.createElement("div",{key:t,className:"lrn_responseText",dangerouslySetInnerHTML:{__html:e.label}})}},{key:"shouldBeVisible",value:function shouldBeVisible(){var e=this.props.validatable,t=e.isShowingCorrectAnswers,n=e.suggestedResponses,r=e.validationState;return!(!t||"correct"===r||!n)}}]),SuggestedAnswersList}(a.a.Component);t.b=l},188:function(e,t,n){"use strict";var r=n(127),o=n.n(r);t.a=function CheckAnswerButton(e){var t=e.base,n=e.validatable,r=e.validatableActions;if(n.canCheckAnswer){var i=t.i18n,a=t.readOnly,s=t.disabled,l=n.canShowCorrectAnswers,c=n.canShowGlobalValidationUI,u=n.feedbackAttemptsCount,f=n.feedbackAttemptsLimit,p=i.labels.checkAnswer,d=!(!a&&!s)||0!==f&&u>=f;return o.a.createElement("button",{type:"button",className:"lrn_btn lrn_validate",disabled:d,onClick:function onClick(){r.checkAnswer({canShowCorrectAnswers:l,canShowGlobalValidationUI:c,skipAttemptCountLimit:!1})}},o.a.createElement("span",null,p))}return null}},206:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(127),a=n.n(i),s=n(131),l=n(129),c=n(21);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(MaskableElement,e);var t=_createSuper(MaskableElement);function MaskableElement(){var e;_classCallCheck(this,MaskableElement);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _defineProperty(_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"maskId",o.a.uniqueId()),_defineProperty(_assertThisInitialized(e),"state",{renderComplete:!1}),_defineProperty(_assertThisInitialized(e),"buttonRef",(function(t){var n=e.props.buttonRef;e.button=t,n&&n(t)})),_defineProperty(_assertThisInitialized(e),"onToggleMasking",(function(){var t=e.props,n=t.baseActions,r=t.onChange,o=e.hasMask();r&&r(!o),n.toggleComponentMask(e.maskId)})),e}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(MaskableElement,[{key:"componentDidMount",value:function componentDidMount(){this.setState({renderComplete:!0})}},{key:"hasMask",value:function hasMask(){var e=this.props.base.maskIds;return o.a.contains(e,this.maskId)}},{key:"generateAriaLabel",value:function generateAriaLabel(){var e=this.props,t=e.base,n=e.ariaLabel,r=t.inMaskingState,o=t.i18n.labels.masking;return n&&r?(this.hasMask()?o.ariaLabelUnmask:o.ariaLabelMask)+" - "+n:null}},{key:"render",value:function render(){var e=this,t=this.props,n=t.hidden,r=t.base,o=t.draggable,i=r.inMaskingState,s=r.disabled,l=this.state.renderComplete,c=this.hasMask(),u=!n&&(c||i),f=o&&i,p=s?void 0:this.onToggleMasking;if(!u)return null;var d=function(){if(c&&l){var t=e.button,n=t.clientWidth,r=t.clientHeight;return e.generateMask(n,r)}return null}(),h=!i||void 0;return a.a.createElement("button",{type:"button",className:"lrn-mask",onClick:p,onTouchEnd:f?p:null,disabled:!i,ref:this.buttonRef,"aria-label":this.generateAriaLabel(),"aria-hidden":h},d)}},{key:"generateMask",value:function generateMask(e,t){for(var n=e+t,r=[],o=15;o<n;o+=15)r.push(a.a.createElement("line",{key:o,className:"lrn-line1",x1:"0",y1:o,x2:o,y2:"0"}));return(a.a.createElement("svg",{className:"lrn-mask",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"transparent"}),r))}}]),MaskableElement}(a.a.Component);u=l.b((function(e){return{base:e.base}}),(function(e){return{baseActions:s.b(c.a,e)}}))(u),t.a=u},85:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=(n(5),n(0)),a=n.n(i),s=n(52),l=n(17),c=n.n(l),u=n(223),f=/<br[^>]*>/gi,p=new u.a("[\\p{L}\\p{N}]"),d=["br","code","hr","img","pre","math","maligngroup","malignmark","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mlongdiv","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mscarries","mscarry","msgroup","msline","mspace","msqrt","msrow","mstack","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],h={tokenizeSentence:function tokenizeSentence(e,t,n){var r=o()("<div>").html(e).html(),i=o()("<div>").html(e),s=new RegExp("(((?!["+t+"]['\"]?\\s).)*["+t+"]?['\"]?)(\\s|$)","g");return i.find("p").each((function(){var e=o()(this).text();if(e.length){var t=e.replace(s,'<span class="'+n+'">$1</span>$3');t=t.replace('<span class="'+n+'"></span>',""),a.a.isString(r)&&(r=r.replace(e,t))}})),r},tokenizeParagraph:function tokenizeParagraph(e,t){var n=o()("<div>").html(e);return n.find("p").addClass(t),n.html()},tokenizeWord:function tokenizeWord(e,t){e.replace(f," ");var n=o()("<div>").html(e),r=d.join(",");return n.find("*").addBack().not(r).contents().each((function(){if(3===this.nodeType&&0===o()(this).parents(r).length){var e=o()(this).text().split(/\s+/);a.a.each(e,(function(n,r){var o;n.length>0&&p.test(n)&&(o=function trimWord(e){for(var t=0;t<e.length&&!p.test(e[t]);)e=e.substr(1);for(t=e.length-1;t>0&&!p.test(e[t]);)t=(e=e.substr(0,e.length-1)).length-1;return e}(n),e[r]=n.replace(o,'<span class="'+t+'">'+o+"</span>"))})),o()(this).replaceWith(e.join(" "))}})),n.html()}},y=n(10),v=n(35);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=["exactMatch","partialMatch","partialMatchV2"],_=function canValidateResponse(e){if(!1===a.a.getNested(e,"validation.automarkable"))return!1;var t=e.validation||e,n=t&&a.a.isArray(t.valid_responses),r=t&&a.a.isObject(t.valid_response);return n||r&&!function isDefaultValidResponseValue(e){return 0===a.a.filter(e,(function(e){return e||0===e})).length}(t.valid_response.value)},g=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(TokenHighlightScorer,e);var t=_createSuper(TokenHighlightScorer);function TokenHighlightScorer(){return _classCallCheck(this,TokenHighlightScorer),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(TokenHighlightScorer,[{key:"reset",value:function reset(e){var t=JSON.stringify(e);if(this.serializedData!==t){try{this.scoringData=function getScoringData(e){var t=e.question.validation,n=[];if(!_(e.question))return{automarkable:!1};if(e.response=e.response||{},t&&t.scoring_type){if(!a.a.contains(b,t.scoring_type))throw new y.a.InvalidScoringTypeException(e.question.type,t.scoring_type);return t.valid_response&&n.push(t.valid_response),t.alt_responses&&(n=n.concat(t.alt_responses)),function processResponsesCurrentScoringFormat(e,t){var n={score:1,penaltyScore:0,rounding:"floor"};return y.a.scoreArray(e,t,n,{ignoreOrder:!0})}(e,n)}return function processLegacyResponsesPre2140(e){var t,n,r,o=e.question.validation,i=o.valid_responses,s=e.response.value||[],l=a.a.isNumber(o.valid_score)?o.valid_score:1,c=Math.abs(a.a.isNumber(o.penalty_score)?o.penalty_score:0),u=[];i&&(r=l*i.length,s.length&&(n=0,t=!1,a.a.each(s,(function(e){a.a.contains(i,e)?(n+=l,u.push(!0),t=i.length===s.length):(n-=c,u.push(!1))})),!1===o.partial_scoring&&n!==r&&(n=0,t=!1)));return{score:n,maxScore:r,responsesValid:u,isValid:t}}(e=y.a.normalizeParameters(e))}(JSON.parse(JSON.stringify(e))),y.a.normalizeScores(this.scoringData,e)}catch(e){this.scoringData={error:e}}this.serializedData=t}return this}}]),TokenHighlightScorer}(v.a);var m=function cleanTemplate(){var e=this.get("question").tokenization;if(this.get("question").template&&(this.get("question").template=c.a.sanitizeHTML(this.get("question").template)),"custom"!==e){var t=o()("<div>").html(this.get("question").template),n=t.find("."+this.TOKEN_MARKER);n.length&&(n.removeClass(this.TOKEN_MARKER),this.get("question").template=t.html())}},S=s.a.extend({TOKEN_MARKER:"lrn_token",VALID_TOKENIZATION:["sentence","word","paragraph","custom"],DEFAULT_TOKENIZATION:"sentence",SENTENCE_DELIMITERS:".!?",initialize:function initialize(){s.a.prototype.initialize.apply(this,arguments),this.template=this.tokenizeTemplate()},validateStartup:function validateStartup(){s.a.prototype.validateStartup.call(this),m.call(this),this.max_selection=function checkMaxSelection(e){var t=isNaN(e)?0:parseInt(e,10);return t>0?t:0}(this.get("question").max_selection)},processResponseValue:function processResponseValue(e){this.hasResponse()||this.set({response:{value:[],type:this.RESPONSE_TYPE.ARRAY}},{silent:!0}),this.get("response").value=e},getScorerClass:function getScorerClass(){return g},validateResponse:function validateResponse(){return this.getScorer().validateIndividualResponses()},getTemplate:function getTemplate(){return this.template},getMaxSelection:function getMaxSelection(){return this.max_selection},mapValidationMetadataToResponseState:function mapValidationMetadataToResponseState(e){var t=this.getResponseValidDetailed().partial,n=this.getMappableResponses();return a.a.chain(n).filter((function isTargetResponse(n,r){var o;return"unattempted"===e.targetState?a.a.isNull(n):(o="correct"===e.targetState,a.a.isNumber(n)&&t[r]===o)})).map((function metadataInfoForResponse(t,n){return{value:t,metadata:e.metadata[t],index:n}})).value()},isReachedLimit:function isReachedLimit(){var e=this.getResponseValue();return 0!==this.getMaxSelection()&&(!!e&&e.length>=this.getMaxSelection())},tokenizeTemplate:function tokenizeTemplate(){var e=[],t=this.get("question").template,n=this.get("question").tokenization;if(t){switch(n){case"custom":e=t;break;case"paragraph":e=h.tokenizeParagraph(t,this.TOKEN_MARKER);break;case"word":e=h.tokenizeWord(t,this.TOKEN_MARKER);break;default:e=h.tokenizeSentence(t,this.SENTENCE_DELIMITERS,this.TOKEN_MARKER)}e=this.addTokenIndex(e)}return e},addTokenIndex:function addTokenIndex(e){var t=o()("<div>").html(e);return t.find("."+this.TOKEN_MARKER).each((function(e){o()(this).attr({"data-index":e})})),t.html()}}),O=n(177),R=n(127),k=n.n(R),P=n(130),E=n.n(P),w=n(129),T=n(131),C=n(179),I=n(21),A={TOKENHIGHLIGHT_UPDATE_HIGHLIGHTED_TOKENS:"tokenhighlight: updateHighlightedTokens",TOKENHIGHLIGHT_UPDATE_TOKENS_VALIDATION_UI:"tokenhighlight: updateTokensValidationUI"};var N={actionTypes:A,updateHighlightedTokens:function updateHighlightedTokens(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isSilent:!1};return function(n,r){n({type:A.TOKENHIGHLIGHT_UPDATE_HIGHLIGHTED_TOKENS,payload:{selectedTokens:e}});var o=r().tokenhighlight.tokens,i=a.a.filter(o,(function(e){return e.highlighted})),s=a.a.pluck(i,"value");t.isSilent||n(I.a.updateResponseValue(s))}},updateTokensValidationUI:function updateTokensValidationUI(e){return function(t){t({type:A.TOKENHIGHLIGHT_UPDATE_TOKENS_VALIDATION_UI,payload:{validatedResponses:e}})}}},j=n(128),L=n.n(j),D=n(135),M=n(206);function token_typeof(e){return(token_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function token_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function token_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function token_setPrototypeOf(e,t){return(token_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function token_createSuper(e){var t=function token_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=token_getPrototypeOf(e);if(t){var o=token_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return token_possibleConstructorReturn(this,n)}}function token_possibleConstructorReturn(e,t){if(t&&("object"===token_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return token_assertThisInitialized(e)}function token_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function token_getPrototypeOf(e){return(token_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(e){!function token_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&token_setPrototypeOf(e,t)}(Token,e);var t=token_createSuper(Token);function Token(){var e;token_classCallCheck(this,Token);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _defineProperty(token_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"masked",!1),_defineProperty(token_assertThisInitialized(e),"state",{hover:!1}),_defineProperty(token_assertThisInitialized(e),"onMouseEnter",(function(){e.setState({hover:!0})})),_defineProperty(token_assertThisInitialized(e),"onMouseLeave",(function(){e.setState({hover:!1})})),e}return function token_createClass(e,t,n){return t&&token_defineProperties(e.prototype,t),n&&token_defineProperties(e,n),e}(Token,[{key:"componentDidMount",value:function componentDidMount(){var e=this.props,t=e.renderMathIfRequired;e.base.isMath&&t()}},{key:"validationLabels",value:function validationLabels(e){var t=this.props,n=t.content,r=t.validatable,o=t.base,i=o.isMath,a=o.i18n,s=r.validationState;return D.a.getResponseAccessibility({isMath:i,validationState:s,state:e,value:n,ariaLiveLabels:a.labels.ariaLiveText})}},{key:"highlightedLabels",value:function highlightedLabels(){var e=this.props,t=e.highlighted,n=e.content;return t?"Highlighted: ".concat(n):"Not highlighted: ".concat(n)}},{key:"tokenValidationOptions",value:function tokenValidationOptions(){var e,t=this.props,n=t.highlighted,r=t.value,o=t.validated,i=t.mapValidatedResponses,s=t.validatable,l=t.base.isReviewState,c=s.suggestedResponses,u=s.isShowingCorrectAnswers,f=s.validatedResponses,p=a.a.findWhere(i,{value:r}),d=!l&&p?p.validated:o;return n&&f||!a.a.isUndefined(o)?e=d?"correct":"incorrect":c&&a.a.contains(c.value,r)&&u&&(e="valid"),{validationClass:e?"lrn_".concat(e):"",state:e}}},{key:"render",value:function render(){var e=this,t=this.props,n=this.state.hover,r=t.content,o=t.value,i=t.onToggle,a=t.highlighted,s=t.validatable,l=t.base,c=l.inMaskingState,u=l.isMath,f=l.disabled,p=s.validatedResponses,d=this.tokenValidationOptions(),h=d.validationClass,y=d.state,v=L()({lrn_tokenhighlight_highlight:a,lrn_tokenhighlight_hover:n&&!c&&!f,lrn_mask_hover:n&&c,lrn_math:u},"lrn_token ".concat(h)),b=p?this.validationLabels(y).label:this.highlightedLabels();return k.a.createElement("span",{"aria-label":function mathAriaLabel(){if(u)return"".concat(b,": ").concat(r)}()},k.a.createElement("span",{role:"button",tabIndex:"0",className:v,"aria-pressed":a,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:function onClick(e){return i&&i(e,o)},onKeyPress:function onKeyPress(e){return i&&i(e,o)},ref:function ref(t){return e.el=t}},k.a.createElement("span",{dangerouslySetInnerHTML:{__html:r}}),k.a.createElement("span",{className:"sr-only"},b),k.a.createElement(M.a,{hidden:a,onChange:function onChange(t){return e.masked=t}})))}}]),Token}(R.Component),V=x=Object(w.b)((function(e){return{base:e.base,validatable:e.validatable}}),(function(e){return{renderMathIfRequired:Object(T.b)(I.a.renderMathIfRequired,e)}}),null,{forwardRef:!0})(x),z=n(134),H=n(23);function tokenhighlight_typeof(e){return(tokenhighlight_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tokenhighlight_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function tokenhighlight_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tokenhighlight_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tokenhighlight_createClass(e,t,n){return t&&tokenhighlight_defineProperties(e.prototype,t),n&&tokenhighlight_defineProperties(e,n),e}function tokenhighlight_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tokenhighlight_setPrototypeOf(e,t)}function tokenhighlight_setPrototypeOf(e,t){return(tokenhighlight_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function tokenhighlight_createSuper(e){var t=function tokenhighlight_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=tokenhighlight_getPrototypeOf(e);if(t){var o=tokenhighlight_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tokenhighlight_possibleConstructorReturn(this,n)}}function tokenhighlight_possibleConstructorReturn(e,t){if(t&&("object"===tokenhighlight_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tokenhighlight_assertThisInitialized(e)}function tokenhighlight_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tokenhighlight_getPrototypeOf(e){return(tokenhighlight_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=C.a.ValidatableQuestion,B=C.a.ResponseInput,F=function(e){tokenhighlight_inherits(Tokens,e);var t=tokenhighlight_createSuper(Tokens);function Tokens(){return tokenhighlight_classCallCheck(this,Tokens),t.apply(this,arguments)}return tokenhighlight_createClass(Tokens,[{key:"componentDidMount",value:function componentDidMount(){var e=this.props.getTokenElements();e&&a.a.map(e,(function(e){return e.innerHTML=""}))}},{key:"render",value:function render(){var e=this.props,t=e.tokens,n=e.getTokenElements,r=e.mapValidatedResponses,o=e.onTokenToggle,i=n();return a.a.map(i,(function(e,n){return E.a.createPortal(k.a.createElement(V,_extends({key:n,onToggle:o,mapValidatedResponses:r},t[n])),e)}))}}]),Tokens}(k.a.Component),W=function(e){tokenhighlight_inherits(TokenHighlight,e);var t=tokenhighlight_createSuper(TokenHighlight);function TokenHighlight(){var e;tokenhighlight_classCallCheck(this,TokenHighlight);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return tokenhighlight_defineProperty(tokenhighlight_assertThisInitialized(e=t.call.apply(t,[this].concat(r))),"onTokenToggle",(function(t,n){var r=e.props,i=r.tokenHighlightActions,s=r.tokenhighlight,l=r.base,c=r.validatableActions,u=l.isReviewState,f=l.isPreviewState,p=l.inMaskingState,d=l.disabled,h=s.hasReachedLimit,y=s.tokens,v="click"===t.type||t.which===z.a.ENTER||t.which===z.a.SPACE,b=o()(t.currentTarget).find("button.lrn-mask").length>0,_=!p&&!b,g=u||f||d,m=a.a.findWhere(y,{value:n}).highlighted;v&&!g&&_&&(h&&m||!h)&&(t.preventDefault(),c.clearValidationUI(),i.updateHighlightedTokens([n]))})),tokenhighlight_defineProperty(tokenhighlight_assertThisInitialized(e),"getTokenElements",(function(){if(e.el)return e.el.querySelectorAll("[data-lrn-token]")})),e}return tokenhighlight_createClass(TokenHighlight,[{key:"mapValidatedResponses",value:function mapValidatedResponses(){var e=this.props,t=e.validatable,n=e.tokenhighlight.tokens,r=t.validatedResponses,o=[];if(a.a.map(n,(function(e){e.highlighted&&o.push(e)})),o.length>0)return a.a.map(o,(function(e,t){return{value:a.a.getNested(e,"value"),validated:r&&r[t]}}))}},{key:"render",value:function render(){var e=this,t=this.props,n=t.tokenhighlight,r=t.validatable,o=t.base,i=o.isReviewState,a=o.isPreviewState,s=o.i18n,l=n.template,c=n.tokenization,u=n.isReachedLimit,f=n.tokens,p=L()({lrn_tokenhighlight_disable_select_more:u,lrn_tokenhighlight_readonly:i||a},"lrn_tokenhighlight_text lrn_tokenhighlight_".concat(c));return k.a.createElement(U,{validatable:r},k.a.createElement("div",{className:"sr-only"},s.labels.ariaLiveText.tokenHighlight.explanation),k.a.createElement(B,{options:{className:"lrn_response_input_wrapper lrn-response-validate-wrapper"},validatable:r},k.a.createElement("div",{className:"lrn_response_input"},k.a.createElement("div",{className:p,dangerouslySetInnerHTML:{__html:l},ref:function ref(t){return e.el=t}}),k.a.createElement(F,{tokens:f,getTokenElements:this.getTokenElements,mapValidatedResponses:this.mapValidatedResponses(),onTokenToggle:this.onTokenToggle}))))}}]),TokenHighlight}(k.a.Component),Q=W=Object(w.b)((function(e){return{base:e.base,validatable:e.validatable,tokenhighlight:e.tokenhighlight}}),(function(e){return{tokenHighlightActions:Object(T.b)(N,e),validatableActions:Object(T.b)(H.a,e)}}))(W),q=n(56),G=n(133);function dataService_typeof(e){return(dataService_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dataService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dataService_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dataService_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dataService_setPrototypeOf(e,t){return(dataService_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function dataService_createSuper(e){var t=function dataService_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,r=dataService_getPrototypeOf(e);if(t){var o=dataService_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dataService_possibleConstructorReturn(this,n)}}function dataService_possibleConstructorReturn(e,t){if(t&&("object"===dataService_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function dataService_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function dataService_getPrototypeOf(e){return(dataService_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K,$=function(e){!function dataService_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dataService_setPrototypeOf(e,t)}(TokenHighlightDataService,e);var t=dataService_createSuper(TokenHighlightDataService);function TokenHighlightDataService(){return dataService_classCallCheck(this,TokenHighlightDataService),t.apply(this,arguments)}return function dataService_createClass(e,t,n){return t&&dataService_defineProperties(e.prototype,t),n&&dataService_defineProperties(e,n),e}(TokenHighlightDataService,[{key:"getInitialState",value:function getInitialState(){var e=_get(dataService_getPrototypeOf(TokenHighlightDataService.prototype),"getInitialState",this).call(this);return a.a.extend(e,{tokenhighlight:{tokens:this.tokens,tokenization:this.tokenization,template:this.template,maxSelection:this.maxSelection,hasReachedLimit:this.hasReachedLimit}})}},{key:"getValidatedResponses",value:function getValidatedResponses(){return this.model.validateResponse()}},{key:"getAriaLiveMessage",value:function getAriaLiveMessage(e){var t=this.getSuggestedResponses()&&this.getSuggestedResponses().value,n=this.getResponse()&&this.getResponse().value,r=this.validateResponse(),o=this.tokens,i=[],s=[],l=[],c=this.activity.get("i18n").labels.ariaLiveText.tokenHighlight;a.a.map(t,(function(e){var t=a.a.findWhere(o,{value:e});i.push(t.content)})),a.a.map(n,(function(e,t){var n=a.a.findWhere(o,{value:e});r[t]?l.push(n.content):s.push(n.content)}));var u=a.a.isEmpty(s)?"":Object(G.a)(c.incorrectAnswers,{answers:s.join(",")}),f=a.a.isEmpty(l)?"":Object(G.a)(c.correctAnswers,{answers:l.join(",")}),p=a.a.isEmpty(i)?"":Object(G.a)(c.expectedAnswers,{answers:i.join(",")});return e?"".concat(u," ").concat(f," ").concat(p):"".concat(u).concat(f)}},{key:"tokens",get:function get(){var e,t=this.template,n=((e=document.createElement("div")).innerHTML=t,e).querySelectorAll("[data-lrn-token]");return a.a.map(n,(function(e,t){return{highlighted:!1,value:t,content:e.innerHTML}}))}},{key:"tokenization",get:function get(){return"custom"}},{key:"template",get:function get(){var e,t=this.model.getTemplate();if(a.a.isUndefined(this._template)&&!a.a.isEmpty(t)){var n=((e=document.createElement("div")).innerHTML=c.a.sanitizeHTML(t),e),r=n.querySelectorAll(".lrn_token");a.a.each(r,(function(e){e.removeAttribute("class"),e.setAttribute("data-lrn-token","")})),this._template=n.innerHTML}return this._template}},{key:"maxSelection",get:function get(){var e=this.question.max_selection;return e?parseInt(e,10):1/0}},{key:"hasReachedLimit",get:function get(){return this.model.isReachedLimit()}}]),TokenHighlightDataService}(q.a),Y=n(25);function reducer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=N.actionTypes,J=(reducer_defineProperty(K={},Z.TOKENHIGHLIGHT_UPDATE_HIGHLIGHTED_TOKENS,(function(e,t){var n=t.selectedTokens,r=e.tokens,o=e.maxSelection;return{tokens:a.a.map(r,(function(e){return a.a.contains(n,e.value)&&(e.highlighted=!e.highlighted),e})),hasReachedLimit:a.a.filter(a.a.pluck(r,"highlighted"),(function(e){return!0===e})).length>=o}})),reducer_defineProperty(K,Z.TOKENHIGHLIGHT_UPDATE_TOKENS_VALIDATION_UI,(function(e,t){var n=e.tokens,r=t.validatedResponses,o=-1;return{tokens:a.a.map(n,(function(e){return r&&e.highlighted?(o++,a.a.extend({},e,{validated:r[o]})):e}))}})),K),X=Object(Y.a)(J,{}),ee=O.a.extend({maskable:!0,ViewComponent:Q,DataService:$,getReducers:function getReducers(){var e=O.a.prototype.getReducers.apply(this,arguments);return a.a.extend(e,{tokenhighlight:X})},prepareStoreState:function prepareStoreState(){var e=this.getStore(),t=this.getDataService();if(t.isResumeState||t.isReviewState){var n=a.a.getNested(t.getResponse(),"value")||[];e.dispatch(N.updateHighlightedTokens(n,{isSilent:!0}))}t.isReviewState&&e.dispatch(N.updateTokensValidationUI(t.getValidatedResponses()))}});t.default={View:ee,Model:S}}}]);